define("arctic-cmd-repo/backbone-layoutmanager/0.9.5/backbone.layoutmanager",["gallery/backbone/1.1.2/backbone","gallery/underscore/1.6.0/underscore","$"],function(a,b){!function(c,d){"use strict";if("function"==typeof define&&define.amd)return define(["backbone","underscore","jquery"],function(){return d.apply(c,arguments)});if("object"==typeof b){var e=a("gallery/backbone/1.1.2/backbone"),f=a("gallery/underscore/1.6.0/underscore");e.$=e.$||a("$"),module.exports=d.call(c,e,f,e.$)}else d.call(c,c.Backbone,c._,c.Backbone.$)}("object"==typeof global?global:this,function(a,b,c){"use strict";var d=this,e=a.View,f=Array.prototype.push,g=Array.prototype.concat,h=Array.prototype.splice,i=String.prototype.trim?b.bind(String.prototype.trim.call,String.prototype.trim):c.trim,j=a.View.extend({_render:function(){var a=this,b=a.__manager__,c=a.beforeRender,d=a.deferred();return a.hasRendered&&a._removeViews(),b.callback=function(){delete b.isAsync,delete b.callback,a.trigger("beforeRender",a),a._viewRender(b).render().then(function(){d.resolve()})},c&&c.call(a,a),b.isAsync||b.callback(),d.promise()},_applyTemplate:function(a,d,e){b.isString(a)&&(d.noel?(a=c.parseHTML(a,!0),this.$el.slice(1).remove(),this.$el.replaceWith(a),this.setElement(a,!1)):this.html(this.$el,a)),e.resolveWith(this,[this])},_viewRender:function(a){function c(b,c){var e;a.callback=function(b){delete a.isAsync,delete a.callback,g._applyTemplate(b,a,f)},j.cache(d,c),c&&(e=g.renderTemplate.call(g,c,b)),a.isAsync||g._applyTemplate(e,a,f)}var d,e,f,g=this;return{render:function(){var h=g.serialize,i=g.template;return f=g.deferred(),b.isFunction(h)&&(h=h.call(g)),a.callback=function(b){delete a.isAsync,delete a.callback,c(h,b)},"string"==typeof i&&(d=g.prefix+i),(e=j.cache(d))?(c(h,e,d),f):("string"==typeof i?e=g.fetchTemplate.call(g,g.prefix+i):"function"==typeof i?e=i:null!=i&&(e=g.fetchTemplate.call(g,i)),a.isAsync||c(h,e),f)}}},constructor:function(c){this.manage=!0,b.extend(this,c),a.View.apply(this,arguments)},async:function(){var a=this.__manager__;return a.isAsync=!0,a.callback},promise:function(){return this.__manager__.renderDeferred.promise()},renderViews:function(){var a=this,b=a.__manager__,c=a.deferred(),d=a.getViews().map(function(a){return a.render().__manager__.renderDeferred}).value();return b.renderDeferred=c.promise(),a.when(d).then(function(){c.resolveWith(a,[a])}),a},insertView:function(a,b){return b?this.setView(a,b,!0):this.setView(a,!0)},insertViews:function(a){return b.isArray(a)?this.setViews({"":a}):(b.each(a,function(c,d){a[d]=b.isArray(c)?c:[c]}),this.setViews(a))},getView:function(a){return null==a&&(a=arguments[1]),this.getViews(a).first().value()},getViews:function(a){var c;return"string"==typeof a?(a=this.sections[a]||a,c=this.views[a]||[],b.chain([].concat(c))):(c=b.chain(this.views).map(function(a){return b.isArray(a)?a:[a]},this).flatten(),"object"==typeof a?c.where(a):"function"==typeof a?c.filter(a):c)},removeView:function(a){return this.getViews(a).each(function(a){a.remove()})},setView:function(a,b,c){var d,e,f=this;if("string"!=typeof a&&(c=b,b=a,a=""),d=b.__manager__,!d)throw new Error("The argument associated with selector '"+a+"' is defined and a View.  Set `manage` property to true for "+"Backbone.View instances.");return d.parent=f,e=d.selector=f.sections[a]||a,c?(f.views[e]=g.call([],f.views[a]||[],b),f.__manager__.insert=!0,b):(f.getView(a)!==b&&f.removeView(a),f.views[e]=b)},setViews:function(a){return b.each(a,function(a,c){return b.isArray(a)?b.each(a,function(a){this.insertView(c,a)},this):(this.setView(c,a),void 0)},this),this},render:function(){function a(){function a(){var a=d.console,c=e.afterRender;c&&c.call(e,e),e.trigger("afterRender",e),g.noel&&e.$el.length>1&&b.isFunction(a.warn)&&!e.suppressWarnings&&(a.warn("`el: false` with multiple top level elements is not supported."),b.isFunction(a.trace)&&a.trace())}var c;return b.each(e.views,function(a,c){b.isArray(a)&&e.htmlBatch(e,a,c)}),h&&!g.insertedViaFragment&&(e.contains(h.el,e.el)||h.partial(h.$el,e.$el,i,g)),e.delegateEvents(),e.hasRendered=!0,(c=g.queue.shift())?c():delete g.queue,i&&i.queue?h.once("afterRender",a):a(),j.resolveWith(e,[e])}function c(){e._render().done(function(){if(!b.keys(e.views).length)return a();var c=b.map(e.views,function(a){var c=b.isArray(a);return c&&a.length?e.when(b.map(a,function(a){return a.__manager__.insertedViaFragment=!0,a.render().__manager__.renderDeferred})):c?a:a.render().__manager__.renderDeferred});e.when(c).done(a)})}var e=this,g=e.__manager__,h=g.parent,i=h&&h.__manager__,j=e.deferred();return g.queue?f.call(g.queue,c):(g.queue=[],c(e,j)),e.__manager__.renderDeferred=j,e},remove:function(){return j._removeView(this,!0),this._remove.apply(this,arguments)}},{_cache:{},_removeViews:function(a,b){"boolean"==typeof a&&(b=a,a=this),a=a||this,a.getViews().each(function(a){(a.hasRendered||b)&&j._removeView(a,b)})},_removeView:function(a,c){var d,e=a.__manager__,f=e.parent&&e.parent.__manager__,g="boolean"==typeof a.keep?a.keep:a.options.keep;if(!g&&f&&f.insert===!0||c){if(j.cleanViews(a),a._removeViews(!0),a.$el.remove(),!e.parent)return;if(d=e.parent.views[e.selector],b.isArray(d))return b.each(b.clone(d),function(a,b){a&&a.__manager__===e&&h.call(d,b,1)});delete e.parent.views[e.selector]}},cache:function(a,b){return a in this._cache&&null==b?this._cache[a]:null!=a&&null!=b?this._cache[a]=b:void 0},cleanViews:function(c){b.each(g.call([],c),function(c){c.unbind(),c.model instanceof a.Model&&c.model.off(null,null,c),c.collection instanceof a.Collection&&c.collection.off(null,null,c),c.stopListening(),b.isFunction(c.cleanup)&&c.cleanup()})},configure:function(c){b.extend(j.prototype,c),c.manage&&(a.View.prototype.manage=!0),c.el===!1&&(a.View.prototype.el=!1),c.suppressWarnings===!0&&(a.View.prototype.suppressWarnings=!0)},setupView:function(c,d){d=b.extend({},d),b.each(g.call([],c),function(c){if(!c.__manager__){var e,f,g=j.prototype;b.defaults(c,{views:{},sections:{},__manager__:{},_removeViews:j._removeViews,_removeView:j._removeView},j.prototype),c.options=d,b.extend(c,d),c._remove=a.View.prototype.remove,c.render=j.prototype.render,c.remove!==g.remove&&(c._remove=c.remove,c.remove=g.remove),e=d.views||c.views,b.keys(e).length&&(f=e,c.views={},b.each(f,function(a,b){"function"==typeof a&&(f[b]=a.call(c,c))}),c.setViews(f))}})}});j.VERSION="0.9.5",a.Layout=j,a.View=function(a){var b;a=a||{},("el"in a?a.el===!1:this.el===!1)&&(b=!0),(a.manage||this.manage)&&j.setupView(this,a),this.__manager__&&(this.__manager__.noel=b,this.__manager__.suppressWarnings=a.suppressWarnings),e.apply(this,arguments)},a.View.extend=e.extend,a.View.prototype=e.prototype;var k={prefix:"",deferred:function(){return c.Deferred()},fetchTemplate:function(a){return b.template(c(a).html())},renderTemplate:function(a,b){return i(a.call(this,b))},serialize:function(){return this.model?b.clone(this.model.attributes):{}},partial:function(a,b,c,d){var e;d.selector&&(c.noel?(e=a.filter(d.selector),a=e.length?e:a.find(d.selector)):a=a.find(d.selector)),c.insert?this.insert(a,b):this.html(a,b)},html:function(a,b){a.html(b)},htmlBatch:function(a,d,e){var f=a.__manager__,g={selector:e},h=b.reduce(d,function(b,d){var e="boolean"==typeof d.keep?d.keep:d.options.keep,f=e&&c.contains(a.el,d.el);return d.el&&!f&&b.push(d.el),b},[]);return this.partial(a.$el,c(h),f,g)},insert:function(a,b){a.append(b)},when:function(a){return c.when.apply(null,a)},contains:function(a,b){return c.contains(a,b)}};return b.extend(j.prototype,k),j})});
